-- BP 7.1.6 content: ModelClass syschar: 3 persistence-version: 7.1.6

INSERT INTO O_OBJ
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	'Select From Instances Where',
	611,
	'ACT_FIW',
	'This class represents a statement that selects a set of  instances from a class extent with the support of a where clause.  The where clause consists of a boolean expression containing the special instance handle ''selected''. If the expression evaluates to true, the instance represented by ''selected '' is added to the result set of the statement.
',
	"00000000-0000-0000-0000-000000000000");
INSERT INTO O_TFR
	VALUES ("a5415c8b-cf96-426b-b7f1-bc18f353d8b6",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	'dispose',
	'This operation disconnects an instance, and all instances it is 
responsible for, from the model.',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'select one obj related by self->O_OBJ[R676];
if ( not_empty obj )
  unrelate self from obj across R676;
end if;

select one var related by self->V_VAR[R665];
if ( not_empty var )
  unrelate self from var across R665;
  if ( not var.Declared )
    var.dispose();
  end if;
end if;

select one val related by self->V_VAL[R610];
if ( not_empty val )
  unrelate self from val across R610;
  val.dispose();
end if;
delete object instance self;
',
	1,
	'',
	"00000000-0000-0000-0000-000000000000");
INSERT INTO O_TFR
	VALUES ("8fa6dfac-7e4d-4816-829f-be21073ac7df",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	'execute',
	'',
	"ba5eda7a-def5-0000-0000-000000000000",
	1,
	'// (ACT_FIW) Select from Instances Where.execute()
// select any <handle> from instances of <key letters> where
//                                         selected.<attribute> == <expression>;
// We need to take advantage of the is_implicit attribute
//
// Grab the stack frame
select one body related by self->ACT_SMT[R603]->ACT_BLK[R602]->ACT_ACT[R601];
select any stack_frame from instances of I_STF where
                                selected.Stack_Frame_ID == param.stack_frame_id;
if (empty stack_frame)
  //Invalid stack frame ID!
  pathMsg = "<No Path Available - Empty instance>";
    if (not_empty body)
      pathMsg = body.getPath();
    end if;
	USER::logError(msg:"Error in Selection From Instances Where.execute: Invalid stack frame handle used. Using random top stack frame.",path:pathMsg);
  select any stack from instances of I_STACK;
  select one stack_frame related by stack->I_STF[R2929];
end if;

// get the current execution engine
select one engine related by stack_frame->I_STACK[R2943]->I_EXE[R2930];

select any sel_ref related by stack_frame->I_BSF[R2923]->
                                                     L_LCL[R3000]->L_LSR[R3001];
if (empty sel_ref)
  // If there isn''t one, create it and link it to the outer block
  select one outer_block related by self->ACT_SMT[R603]->ACT_BLK[R602]->
                                                   ACT_ACT[R601]->ACT_BLK[R666];
  ref_ID = outer_block.newLocalSelectedReference(stack_frame_id:
                                                    stack_frame.Stack_Frame_ID);
  select any sel_ref related by stack_frame->I_BSF[R2923]->
                 L_LCL[R3000]->L_LSR[R3001] where (selected.Local_ID == ref_ID);
end if;
// Get the right local reference for the instance reference target
// in this block in stack frame
// Set value to this block with the right type so we can use it later.
// The value here is useless.
select any local_ref from instances of L_LCR;
select one inst_ref related by sel_ref->L_IWC[R3006];
if (self.is_implicit and empty inst_ref)
  // This is the first use of this lefthand variable
  // _and_ we''ve not yet started iterating.
  // Create the selection result instance reference
  // in the scope of the enclosing block.
  select one block related by self->ACT_SMT[R603]->ACT_BLK[R602];
  ref_ID = block.newLocalReference(stack_frame_id: param.stack_frame_id);
  select any local_ref related by block->I_BSF[R2923]->L_LCL[R3000]->
                               L_LCR[R3001] where (selected.Local_ID == ref_ID);
  if (self.cardinality == "many")
    select one inst_set related by self->V_VAR[R665]->V_INS[R814];
    relate inst_set to local_ref across R3003;
  else
    select one inst_handle related by self->V_VAR[R665]->V_INT[R814];
    relate inst_handle to local_ref across R3004;
  end if;
else
  // Set up the target refererence variable
  target_var_ID = GD::NULL_UNIQUE_ID();
  if (self.cardinality == "many")
    select one inst_set related by self->V_VAR[R665]->V_INS[R814];
    target_var_ID = inst_set.Var_ID;
  else
    select one inst_handle related by self->V_VAR[R665]->V_INT[R814];
    target_var_ID = inst_handle.Var_ID;
  end if;
  // Get all of the block in stack frames that exist for the stack frame
  select many block_in_stack_frames related by stack_frame->I_BSF[R2923];
  for each block_in_stack_frame in block_in_stack_frames
    // Find the one local reference that matches the block in stack frame
    // where we are executing for the transient variable we want to assign
    select any local_ref related by block_in_stack_frame->L_LCL[R3000]->
                          L_LCR[R3001] where selected.Var_ID == target_var_ID;
    if (not_empty local_ref)
      // We found the 1 local reference in this stack frame for this instance
      // handle id.  So stop looking.
      // All of this was necessary in order to support nested blocks that
      // reference variables that were created in outer blocks in this stack
      // frame
      // WARNING: This implementation is based on the Object Action Language
      // definition that existed in November of 2005.
      // If the language is changed to become a strongly typed language where
      // a user can define a variable in an inner block with the same
      // name as something that exists in the outer block, then this
      // implementation will not work because it does not walk out of the
      // current block.
      break;
    end if;
  end for;
end if;
if (empty inst_ref)
  // We haven''t begun to iterate yet, clear stale
  // selections . . .
  select one inst_set related by self->V_VAR[R665]->V_INS[R814];
  select many staleInsts related by inst_set->L_LCR[R3003]->L_LCL[R3001]->
        RV_RVL[R3306]->RV_SMV[R3300]->RV_IRV[R3308]->L_IIR[R3311]->I_INS[R3013];
  if (empty inst_set)
    select one inst_handle related by self->V_VAR[R665]->V_INT[R814];
    select many staleInsts related by inst_handle->
                  L_LCR[R3004]->L_LCL[R3001]->RV_RVL[R3306]->
                       RV_SMV[R3300]->RV_IRV[R3308]->L_IIR[R3311]->I_INS[R3013];
  end if;
  for each inst in staleInsts
    local_ref.purge(inst_id:inst.Inst_ID);
  end for;
  // . . . and set up the instance extent for iteration
  sel_ref_initialized = false;
  select many cies related by self->O_OBJ[R676]->CSME_CIE[R2961]
             where (selected.Execution_Engine_ID == engine.Execution_Engine_ID);
  select many insts related by cies->I_INS[R2962];
  select any prev_inst_in_where from instances of L_IWC;
  for each inst in insts
    create object instance inst_in_where of L_IWC;
    relate inst to inst_in_where across R3014;
    if (sel_ref_initialized == false)
      // Point the selection reference to the first instance
      relate inst_in_where to sel_ref across R3006;
      inst_ref = inst_in_where;
      sel_ref_initialized = true;
    else
      // Chain the instances together
      relate inst_in_where to prev_inst_in_where across R3016.''is after'';
    end if;
    prev_inst_in_where = inst_in_where;
  end for;
end if;
if not_empty inst_ref
  select one where_clause related by self->V_VAL[R610];
  // The where_clause value contains the Boolean result of the expression 
  // written in the OAL statement
  // For each instance in the set, if the user supplied
  // where clause evaluates to TRUE, then add it to the set.
  where_clause.computeValue(stack_frame_id: stack_frame.Stack_Frame_ID);
  select any result related by stack_frame->I_VSF[R2951] where
                                     selected.Value_ID == where_clause.Value_ID;
  select one rtVal related by result->RV_RVL[R3305];
  if (empty rtVal)
    // result requires computation. Return and let the new stack frame execute
    return;      
  end if;
  stack_frame.popValue(value_id:where_clause.Value_ID);
  select one inst_in_where related by sel_ref->L_IWC[R3006];
  if (not_empty inst_in_where)
    select one inst related by inst_in_where->I_INS[R3014];
    selectionPassed = GD::instance_to_boolean(value:rtVal.getValue());
    if ( selectionPassed == TRUE )
      local_ref.addInstance(inst_id:inst.Inst_ID);
    end if;
    select one next_inst_in_where related by inst_in_where->
                                                       L_IWC[R3016.''is before''];
    unrelate inst_in_where from sel_ref across R3006;
    // We''ve visited this instance, dispose the reference
    inst_in_where.dispose();
    if (self.cardinality == "many" or not selectionPassed)
      if (not_empty next_inst_in_where)
        relate next_inst_in_where to sel_ref across R3006;
      end if;
    else
      // We got our result and we''re done, dispose all remaining references
      while (not_empty next_inst_in_where)
        select one next_next_inst_in_where related by inst_in_where->
                                                       L_IWC[R3016.''is before''];
        next_inst_in_where.dispose();
        next_inst_in_where = next_next_inst_in_where;
      end while;
    end if;
  end if;
end if;',
	1,
	'',
	"a5415c8b-cf96-426b-b7f1-bc18f353d8b6");
INSERT INTO O_TPARM
	VALUES ("6b8493dd-78b5-4b22-9b5a-db81d3b52656",
	"8fa6dfac-7e4d-4816-829f-be21073ac7df",
	'stack_frame_id',
	"ba5eda7a-def5-0000-0000-000000000005",
	0,
	'',
	"00000000-0000-0000-0000-000000000000",
	'');
INSERT INTO O_REF
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"4f42b756-0c2e-4a87-b40f-87291682433c",
	0,
	"9bdc49e0-583c-4741-ad6c-fa52d80977a5",
	"df5d83da-30d6-4d47-b2e9-e0558c45efd8",
	"d5662264-7e21-4b50-a4d9-59b239e648bf",
	"7558839e-e4fb-46e4-97b0-decfec373abb",
	"2111ad1c-edac-4e3e-aa8d-1cc3a4afd3b8",
	"549d0b7e-718d-4296-a014-3df24432d5fb",
	"00000000-0000-0000-0000-000000000000",
	0,
	'',
	'Statement',
	'Statement_ID',
	'R603');
INSERT INTO R_RGO_PROXY
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"df5d83da-30d6-4d47-b2e9-e0558c45efd8",
	"d5662264-7e21-4b50-a4d9-59b239e648bf",
	'../../Body/Body.xtuml');
INSERT INTO O_RTIDA_PROXY
	VALUES ("9bdc49e0-583c-4741-ad6c-fa52d80977a5",
	"4f42b756-0c2e-4a87-b40f-87291682433c",
	0,
	"df5d83da-30d6-4d47-b2e9-e0558c45efd8",
	"7558839e-e4fb-46e4-97b0-decfec373abb",
	'../../Body/Body.xtuml');
INSERT INTO O_RATTR
	VALUES ("2111ad1c-edac-4e3e-aa8d-1cc3a4afd3b8",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"9bdc49e0-583c-4741-ad6c-fa52d80977a5",
	"4f42b756-0c2e-4a87-b40f-87291682433c",
	1,
	'Statement_ID');
INSERT INTO O_BATTR_PROXY
	VALUES ("9bdc49e0-583c-4741-ad6c-fa52d80977a5",
	"4f42b756-0c2e-4a87-b40f-87291682433c",
	'../../Body/Statement/Statement.xtuml');
INSERT INTO O_ATTR
	VALUES ("2111ad1c-edac-4e3e-aa8d-1cc3a4afd3b8",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"00000000-0000-0000-0000-000000000000",
	'Statement_ID',
	'

',
	'',
	'Statement_ID',
	0,
	"ba5eda7a-def5-0000-0000-000000000007",
	'',
	'');
INSERT INTO O_REF
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"f8c82d33-e7c5-4fb7-8c3c-77b2a47feca7",
	0,
	"5b3f451e-a4bf-4d7c-97db-547eae3c84ae",
	"52e31e92-6363-43ff-8085-e8a19e0b9cfe",
	"6ce58578-2636-4b1b-9a47-18093e4dbf85",
	"fcc9e5c6-0a96-493f-9b1b-60b0226f260e",
	"f1d3dc07-dc8d-43a4-9e60-40d9566551e1",
	"4f3fe142-6a3e-44a5-8da0-e6706771468a",
	"00000000-0000-0000-0000-000000000000",
	0,
	'',
	'Variable',
	'Var_ID',
	'R665.''result''');
INSERT INTO R_RGO_PROXY
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"52e31e92-6363-43ff-8085-e8a19e0b9cfe",
	"6ce58578-2636-4b1b-9a47-18093e4dbf85",
	'../Selection.xtuml');
INSERT INTO O_RTIDA_PROXY
	VALUES ("5b3f451e-a4bf-4d7c-97db-547eae3c84ae",
	"f8c82d33-e7c5-4fb7-8c3c-77b2a47feca7",
	0,
	"52e31e92-6363-43ff-8085-e8a19e0b9cfe",
	"fcc9e5c6-0a96-493f-9b1b-60b0226f260e",
	'../Selection.xtuml');
INSERT INTO O_RATTR
	VALUES ("f1d3dc07-dc8d-43a4-9e60-40d9566551e1",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"5b3f451e-a4bf-4d7c-97db-547eae3c84ae",
	"f8c82d33-e7c5-4fb7-8c3c-77b2a47feca7",
	1,
	'Var_ID');
INSERT INTO O_BATTR_PROXY
	VALUES ("5b3f451e-a4bf-4d7c-97db-547eae3c84ae",
	"f8c82d33-e7c5-4fb7-8c3c-77b2a47feca7",
	'../../Value/Variable/Variable.xtuml');
INSERT INTO O_ATTR
	VALUES ("f1d3dc07-dc8d-43a4-9e60-40d9566551e1",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"2111ad1c-edac-4e3e-aa8d-1cc3a4afd3b8",
	'Var_ID',
	'

',
	'',
	'Var_ID',
	0,
	"ba5eda7a-def5-0000-0000-000000000007",
	'',
	'');
INSERT INTO O_NBATTR
	VALUES ("93e09c44-e6eb-4074-93c3-379766360df2",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_BATTR
	VALUES ("93e09c44-e6eb-4074-93c3-379766360df2",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_ATTR
	VALUES ("93e09c44-e6eb-4074-93c3-379766360df2",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"f1d3dc07-dc8d-43a4-9e60-40d9566551e1",
	'is_implicit',
	'Full Name: Is Implicit
Specifies whether the resulting instance handle found is being used for the first time in this scope or not.',
	'',
	'is_implicit',
	0,
	"ba5eda7a-def5-0000-0000-000000000001",
	'',
	'');
INSERT INTO O_NBATTR
	VALUES ("e5780f75-f61e-4dc6-b8d0-17a349546a28",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_BATTR
	VALUES ("e5780f75-f61e-4dc6-b8d0-17a349546a28",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_ATTR
	VALUES ("e5780f75-f61e-4dc6-b8d0-17a349546a28",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"93e09c44-e6eb-4074-93c3-379766360df2",
	'cardinality',
	'Full Name: Selection Cardinality
Specifies whether the selection produces a set or an instance as a result.    The cardinality value can be one of the following: one, any, or many. ',
	'',
	'cardinality',
	0,
	"ba5eda7a-def5-0000-0000-000000000004",
	'',
	'');
INSERT INTO O_REF
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"43ea4f47-4fe8-4167-8153-9e199477d0fd",
	0,
	"6e185a42-0dc6-4b9d-9d4b-38cb7c8aa772",
	"c98c73a5-d0a3-4b13-a8b7-7383aa643aaf",
	"47f41b17-d7ee-41ec-a630-5490c7fdda1f",
	"455d8015-1dec-4239-b70c-ce53cc41d0b7",
	"dd22ba2a-6436-48bd-9e3e-369c02f37d0d",
	"e0fd0624-07a5-4be2-8763-e83f53ec6785",
	"00000000-0000-0000-0000-000000000000",
	0,
	'',
	'Value',
	'Value_ID',
	'R610.''where clause''');
INSERT INTO R_RGO_PROXY
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"c98c73a5-d0a3-4b13-a8b7-7383aa643aaf",
	"47f41b17-d7ee-41ec-a630-5490c7fdda1f",
	'../Selection.xtuml');
INSERT INTO O_RTIDA_PROXY
	VALUES ("6e185a42-0dc6-4b9d-9d4b-38cb7c8aa772",
	"43ea4f47-4fe8-4167-8153-9e199477d0fd",
	0,
	"c98c73a5-d0a3-4b13-a8b7-7383aa643aaf",
	"455d8015-1dec-4239-b70c-ce53cc41d0b7",
	'../Selection.xtuml');
INSERT INTO O_RATTR
	VALUES ("dd22ba2a-6436-48bd-9e3e-369c02f37d0d",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"6e185a42-0dc6-4b9d-9d4b-38cb7c8aa772",
	"43ea4f47-4fe8-4167-8153-9e199477d0fd",
	1,
	'Value_ID');
INSERT INTO O_BATTR_PROXY
	VALUES ("6e185a42-0dc6-4b9d-9d4b-38cb7c8aa772",
	"43ea4f47-4fe8-4167-8153-9e199477d0fd",
	'../../Value/Value/Value.xtuml');
INSERT INTO O_ATTR
	VALUES ("dd22ba2a-6436-48bd-9e3e-369c02f37d0d",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"e5780f75-f61e-4dc6-b8d0-17a349546a28",
	'Where_Clause_Value_ID',
	'

',
	'Where_Clause_',
	'Value_ID',
	1,
	"ba5eda7a-def5-0000-0000-000000000007",
	'',
	'');
INSERT INTO O_NBATTR
	VALUES ("a42fac89-406f-4706-bc44-fa1048c9eda5",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_BATTR
	VALUES ("a42fac89-406f-4706-bc44-fa1048c9eda5",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_ATTR
	VALUES ("a42fac89-406f-4706-bc44-fa1048c9eda5",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"44236427-6991-4748-a565-b4b81b154d21",
	'extentLineNumber',
	'',
	'',
	'extentLineNumber',
	0,
	"ba5eda7a-def5-0000-0000-000000000002",
	'',
	'');
INSERT INTO O_NBATTR
	VALUES ("e2f62d75-100d-4d7b-94bf-25f09d86687f",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_BATTR
	VALUES ("e2f62d75-100d-4d7b-94bf-25f09d86687f",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_ATTR
	VALUES ("e2f62d75-100d-4d7b-94bf-25f09d86687f",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"a42fac89-406f-4706-bc44-fa1048c9eda5",
	'extentColumn',
	'',
	'',
	'extentColumn',
	0,
	"ba5eda7a-def5-0000-0000-000000000002",
	'',
	'');
INSERT INTO O_REF
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"62b192ed-f270-47e4-8624-0b8083c5e152",
	0,
	"17d86b5f-0053-47ae-8312-48e5145617f0",
	"20d86d8b-105b-409c-b060-7ac068ab9b82",
	"fa8cc4e9-2c65-4d94-9712-19feee23813f",
	"452b72f6-3012-46fb-83d0-f3a55d1f0937",
	"44236427-6991-4748-a565-b4b81b154d21",
	"5c03e3b5-39a2-4070-890f-a5a07e06a282",
	"00000000-0000-0000-0000-000000000000",
	0,
	'',
	'Model Class',
	'Obj_ID',
	'R676.''from extent of''');
INSERT INTO R_RGO_PROXY
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"20d86d8b-105b-409c-b060-7ac068ab9b82",
	"fa8cc4e9-2c65-4d94-9712-19feee23813f",
	'../Selection.xtuml');
INSERT INTO O_RTIDA_PROXY
	VALUES ("17d86b5f-0053-47ae-8312-48e5145617f0",
	"62b192ed-f270-47e4-8624-0b8083c5e152",
	0,
	"20d86d8b-105b-409c-b060-7ac068ab9b82",
	"452b72f6-3012-46fb-83d0-f3a55d1f0937",
	'../Selection.xtuml');
INSERT INTO O_RATTR
	VALUES ("44236427-6991-4748-a565-b4b81b154d21",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"6c0ac341-1d88-4650-b3fe-2c344b920ed1",
	"6af35b2a-8145-4e12-9330-bfc209409bb6",
	1,
	'Element_ID');
INSERT INTO O_BATTR_PROXY
	VALUES ("6c0ac341-1d88-4650-b3fe-2c344b920ed1",
	"6af35b2a-8145-4e12-9330-bfc209409bb6",
	'../../Packageable Element/Packageable Element/Packageable Element.xtuml');
INSERT INTO O_ATTR
	VALUES ("44236427-6991-4748-a565-b4b81b154d21",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	"dd22ba2a-6436-48bd-9e3e-369c02f37d0d",
	'Obj_ID',
	'',
	'',
	'Obj_ID',
	0,
	"ba5eda7a-def5-0000-0000-000000000007",
	'',
	'');
INSERT INTO O_ID
	VALUES (0,
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_OIDA
	VALUES ("2111ad1c-edac-4e3e-aa8d-1cc3a4afd3b8",
	"22fdd323-5465-4568-ac9f-4bc7d1d68511",
	0,
	'Statement_ID');
INSERT INTO O_ID
	VALUES (1,
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO O_ID
	VALUES (2,
	"22fdd323-5465-4568-ac9f-4bc7d1d68511");
INSERT INTO PE_PE
	VALUES ("22fdd323-5465-4568-ac9f-4bc7d1d68511",
	1,
	"506c7424-c813-4e1c-8551-b157c3aa6f07",
	"00000000-0000-0000-0000-000000000000",
	4);
INSERT INTO EP_PKG_PROXY
	VALUES ("506c7424-c813-4e1c-8551-b157c3aa6f07",
	"00000000-0000-0000-0000-000000000000",
	"2f3ea6a7-20e9-405c-b68c-7fba041e7daf",
	'Selection',
	'This subsystem captures concepts related to selections of instances across associations. Association chain, where and instance extent selections are also covered.
Notify_Changes:false
Persistent:false
// This is used by schema_gen to ignore this subsystem (for publication)
TRANSLATE_FOR_EXTERNAL_USE:FALSE
',
	600,
	'../Selection.xtuml');
