-- BP 7.1.6 content: Component syschar: 3 persistence-version: 7.1.6

INSERT INTO C_C
	VALUES ("0904c6e9-c370-49d8-bf27-782a1e59a175",
	"00000000-0000-0000-0000-000000000000",
	"00000000-0000-0000-0000-000000000000",
	'UI',
	'Simulates the user interface and has the ability to connect an external GUI
representing the physical watch.

Uses the BridgePoint Java API to connect to an animated version of the watch
while the models are executing in Verifier.

There is also hand-written C code that implments parts of this component to 
allow generated code to connect to the exact same animated watch.',
	0,
	"00000000-0000-0000-0000-000000000000",
	0,
	'');
INSERT INTO C_PO
	VALUES ("6c97dbf6-010a-4198-98d0-1b02c1cd6d31",
	"0904c6e9-c370-49d8-bf27-782a1e59a175",
	'UI',
	0,
	0);
INSERT INTO C_IR
	VALUES ("8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf",
	"137804a2-cc70-4699-b997-945bb262d075",
	"00000000-0000-0000-0000-000000000000",
	"6c97dbf6-010a-4198-98d0-1b02c1cd6d31");
INSERT INTO C_P
	VALUES ("8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf",
	'UI',
	'Unnamed Interface',
	'',
	'UI::UI::UI');
INSERT INTO SPR_PEP
	VALUES ("e064ebe6-9250-4f6d-9457-c15d537e12f7",
	"77e380a4-5ca9-4563-a4d5-da5e3d415460",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PS
	VALUES ("e064ebe6-9250-4f6d-9457-c15d537e12f7",
	'lapResetPressed',
	'',
	'',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("77e380a4-5ca9-4563-a4d5-da5e3d415460",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'lapResetPressed',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("7dd6da74-7fde-4f17-aef1-8bf54cf1bbad",
	"117a7b4b-2e13-4b25-be1c-75138a74b543",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PS
	VALUES ("7dd6da74-7fde-4f17-aef1-8bf54cf1bbad",
	'startStopPressed',
	'',
	'',
	0);
INSERT INTO C_EP_PROXY
	VALUES ("117a7b4b-2e13-4b25-be1c-75138a74b543",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'startStopPressed',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("54cabe2d-252f-4864-b174-e16bb448a2f5",
	"5daf9c2d-89f7-4b29-be0d-cef313729f10",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PS
	VALUES ("54cabe2d-252f-4864-b174-e16bb448a2f5",
	'lightPressed',
	'',
	'',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("5daf9c2d-89f7-4b29-be0d-cef313729f10",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'lightPressed',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("fe71630f-962d-4bbe-a1ca-e549cf05b61a",
	"61659283-62a1-417a-b5a9-b52061d1850d",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PS
	VALUES ("fe71630f-962d-4bbe-a1ca-e549cf05b61a",
	'modePressed',
	'',
	'',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("61659283-62a1-417a-b5a9-b52061d1850d",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'modePressed',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("c626964c-b2d7-43c8-825f-19b5a25d45cc",
	"71c0b484-78fd-495f-92e7-a64d9ea3df42",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PS
	VALUES ("c626964c-b2d7-43c8-825f-19b5a25d45cc",
	'setTargetPressed',
	'',
	'',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("71c0b484-78fd-495f-92e7-a64d9ea3df42",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'setTargetPressed',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("f0e7bb44-b88f-4d23-a732-f3a9866d21cf",
	"6573c719-c947-49cb-88b8-c719f0818d7d",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PO
	VALUES ("f0e7bb44-b88f-4d23-a732-f3a9866d21cf",
	'setTime',
	'',
	'GuiBridge::setTime(time: param.time);',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("6573c719-c947-49cb-88b8-c719f0818d7d",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'setTime',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("59974ca3-545c-4a1b-9105-3995c5efe454",
	"bceb5189-9e7f-40c2-8e66-8a420decd2e5",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PO
	VALUES ("59974ca3-545c-4a1b-9105-3995c5efe454",
	'setData',
	'',
	'if (param.unit == Unit::km)
  GuiBridge::setData(value: param.value, unit: 0);
elif (param.unit == Unit::meters)
  GuiBridge::setData(value: param.value, unit: 1);
elif (param.unit == Unit::minPerKm)
  GuiBridge::setData(value: param.value, unit: 2);
elif (param.unit == Unit::kmPerHour)
  GuiBridge::setData(value: param.value, unit: 3);
elif (param.unit == Unit::miles)
  GuiBridge::setData(value: param.value, unit: 4);
elif (param.unit == Unit::yards)
  GuiBridge::setData(value: param.value, unit: 5);
elif (param.unit == Unit::feet)
  GuiBridge::setData(value: param.value, unit: 6);
elif (param.unit == Unit::minPerMile)
  GuiBridge::setData(value: param.value, unit: 7);
elif (param.unit == Unit::mph)
  GuiBridge::setData(value: param.value, unit: 8);
elif (param.unit == Unit::bpm)
  GuiBridge::setData(value: param.value, unit: 9);
elif (param.unit == Unit::laps)
  GuiBridge::setData(value: param.value, unit: 10);
end if;

',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("bceb5189-9e7f-40c2-8e66-8a420decd2e5",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'setData',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("9fcdf739-9526-4b37-8022-c857b1125918",
	"9be1088e-f072-4df8-a585-01762c90c718",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PO
	VALUES ("9fcdf739-9526-4b37-8022-c857b1125918",
	'startTest',
	'',
	'generate TestCase2:start(iterations: 2) to TestCase creator;',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("9be1088e-f072-4df8-a585-01762c90c718",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'startTest',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("cf34c3a7-4073-4419-960c-cece8bea332f",
	"77c3c857-2262-460a-afd3-1fd843eaee3d",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PO
	VALUES ("cf34c3a7-4073-4419-960c-cece8bea332f",
	'setIndicator',
	'',
	'// Map values of UIDatatypes/Indicator to values defined in WatchGUI.java.
if ( param.indicator == Indicator::Blank  )
  GuiBridge::setIndicator( value: 0 );
elif ( param.indicator == Indicator::Down )
  GuiBridge::setIndicator( value: 1 );
elif ( param.indicator == Indicator::Flat )
  GuiBridge::setIndicator( value: 2 );
elif ( param.indicator == Indicator::Up )
  GuiBridge::setIndicator( value: 3 );
end if;',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("77c3c857-2262-460a-afd3-1fd843eaee3d",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'setIndicator',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO SPR_PEP
	VALUES ("a39c2c91-758a-41f5-b1af-2ce2e47a5995",
	"117fb33d-b877-4627-b7d0-6473d24fe772",
	"8cd64ed2-cdcd-46ee-bb7f-fff362c47fcf");
INSERT INTO SPR_PS
	VALUES ("a39c2c91-758a-41f5-b1af-2ce2e47a5995",
	'newGoalSpec',
	'',
	'',
	1);
INSERT INTO C_EP_PROXY
	VALUES ("117fb33d-b877-4627-b7d0-6473d24fe772",
	"137804a2-cc70-4699-b997-945bb262d075",
	-1,
	'newGoalSpec',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO C_I_PROXY
	VALUES ("137804a2-cc70-4699-b997-945bb262d075",
	"00000000-0000-0000-0000-000000000000",
	'UI',
	'',
	'../../UIInterfaces/UI/UI.xtuml');
INSERT INTO PE_PE
	VALUES ("0904c6e9-c370-49d8-bf27-782a1e59a175",
	1,
	"91416729-ea3a-45c0-ac4f-392f31627711",
	"00000000-0000-0000-0000-000000000000",
	2);
INSERT INTO EP_PKG_PROXY
	VALUES ("91416729-ea3a-45c0-ac4f-392f31627711",
	"80afc8ce-7ef5-4cb7-9e96-f31db674dbfc",
	"80afc8ce-7ef5-4cb7-9e96-f31db674dbfc",
	'Library',
	'// ########## START OAL_1 ##########
// always initialize data
self.currentLocation.longitude = 0.0;
self.currentLocation.latitude  = 0.0;
self.currentLocation.speed     = 0.0;
self.interval                  = 2000000;

LOG::LogInfo(message: "Location listener registered.");

 // start timer based on requested interval
create event instance timeout of GPS3:timeout() to self;
self.timer = TIM::timer_start_recurring(event_inst: timeout, microseconds: self.interval);
// ########### END OAL_1 ###########



// ########## START OAL_2 ##########
// prepare signal data with some dummy values that change over time
self.currentLocation.longitude = self.currentLocation.longitude + 2.0;
self.currentLocation.latitude  = self.currentLocation.latitude  + 3.0;
self.currentLocation.speed     = 
                                (self.currentLocation.latitude - 
                                 self.currentLocation.longitude) / 5.0;

// pass the new location to client component
send LocationProvider::locationUpdate(location: self.currentLocation);
// ########### END OAL_2 ###########



// ########## START OAL_3 ##########
res = TIM::timer_cancel(timer_inst_ref: self.timer);
// ########### END OAL_3 ###########



// ########## START OAL_4 ##########
select any gps from instances of GPS;
if (empty gps)
  // asynchronously create a new instance of GPS
  generate GPS1:registerListener() to GPS creator;
end if;
// ########### END OAL_4 ###########


// ########## START OAL_5 ##########
// forward message to single instance of GPS
select any gps from instances of GPS;
if (not empty gps)
  generate GPS2:unregisterListener() to gps;
end if;
// ########### END OAL_5 ###########


// ########## START OAL_6 ##########
// create an instance of the workout timer if it does not exist
select any workoutTimer from instances of WorkoutTimer;
if (empty workoutTimer)
  create object instance workoutTimer of WorkoutTimer;
end if;

// forward message to the single instance of WorkoutTimer 
generate WorkoutTimer1:startStopPressed() to workoutTimer;
// ########### END OAL_6 ###########



// ########## START OAL_7 ##########
// print the new location to the console
LOG::LogInfo(message: "location updated: ");
LOG::LogReal(message: "longitude", r: param.location.longitude);
LOG::LogReal(message: "latitude",  r: param.location.latitude );
LOG::LogReal(message: "speed",     r: param.location.speed    );
// ########### END OAL_7 ###########
',
	0,
	'../Library.xtuml');
